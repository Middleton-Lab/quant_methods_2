---
title: "Problem Set 3"
author:
  - Your Name Here
format: 
  html:
    embed-resources: true
    toc: true
    toc-depth: 2
    toc-title: Contents
---

```{r}
#| echo: false

library(tidyverse)

# Required files for this problem set:
#    - HornedLizards.csv
#    - Earwigs.csv
#    - JetLag.csv
```

## Bayesian workflow

Recall the 7 steps of our Bayesian workflow. Remember that some steps are relatively quick and straightforward (Model specification, Sampling, and Diagnostics -- at least for these models), while others are more involved (Priors and Posteriors).

1. Model specification
2. Prior specification
3. Prior predictive simulation / check
4. Sampling
5. Diagnostics
6. Posterior predictive simulation
7. Summarizing the posterior

We will work through these steps with a few different linear models. All of these models have only 1 predictor and are ones that we used in *Quantitative Methods 1*, either for lecture or in problem sets. So the data should be familiar even if the conclusions are not fresh in your mind.

In this problem set we will be very explicit about following the steps. This is good practice to learn as you are getting familiar with Bayesian inference.


## Difference of means with two groups

t-test-like: horned lizards

Read data

- drop any NA rows

```{r}
# FIXME

HL <- read_csv("../Data/HornedLizards.csv", show_col_types = FALSE) |> 
  drop_na()

HL
```

Plot a histogram of the two groups, faceting rows by group so that the distributions are easier to compare.

```{r}
# FIXME

ggplot(HL, aes(horn_length, fill = group)) +
  geom_histogram(bins = 30) +
  scale_fill_manual(values = c("tomato", "steelblue")) +
  facet_grid(group ~ .) +
  cowplot::theme_cowplot() +
  labs(x = "Horn Length (mm)", y = "Count") +
  theme(legend.position = "none")
```

What do you observe?

> There are many more alive samples than dead (counts are higher overall). The mean for dead looks like it might be lower than for the alive sample, but it's hard to tell. The overlap in the speads is large, with the dead samples completely contained in the range of alive.

Notice that there are a few alive lizards with very small horns. In a regular *t*-test, these observations might be problematic (mathematically problematic by dragging the mean down, rather than scientifically problematic in being erroneous values). In the parlance, these observations have a large "weight" or "leverage" on the mean and, thus, on statistical comparisons of means.

The regularizing priors that we will use will have no problem with these observations. They will be automatically down-weighted in the analysis.

In the chunk below, check sample size, means, and variances for each group:

```{r}
# FIXME

HL |> count(group)

HL |> 
  group_by(group) |> 
  summarize(Mean = mean(horn_length),
            Var = var(horn_length))
```

You will observe that there are about 5 times more alive lizards than dead. *t*-tests work best when sample sizes are fairly close and assume that the variances are equal between groups. Although the variances are very close in this sample, it is deceiving, because the sample sizes are so different. The variance scales with the sample size (larger samples will tend to have larger variances), in contrast to standard deviation (which is scaled to the sample size). If you were going to use a *t*-test for these data, you would probably want to use Welch's correction for unequal variances ("Welch's correction"), which is the default in R.

To prepare the data for passing to `ulam()`, we have to make a change to the formatting of the `group` variable:

- Recode `group` as an integer (`as.integer(factor(group))`)
- Confirm that group is an integer with values of 1 and 2

```{r}
# FIXME

HL <- HL |> 
  mutate(group = as.integer(factor(group)))
unique(HL$group)
```

### Model specification



### Prior specification and prior predictive check



### Sampling

### Diagnostics

### Posterior predictive simulation

### Summarizing the posterior


## Bivariate OLS-like: Earwigs proportion forceps QMLS 1 PS 6

## ANOVA-like: Jet lag knees
