---
title: "Likelihood"
author:
  - Elizabeth King
  - Kevin Middleton
format:
  revealjs:
    theme: [default, custom.scss]
    standalone: true
    self-contained: true
    logo: QMLS_Logo.png
    slide-number: true
    show-slide-number: all
    link-external-newwindow: true
bibliography: Bayes.bib
---

## Probability

```{r}
#| label: setup
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(cowplot)
ggplot2::theme_set(theme_cowplot())
library(lubridate)

library(Data4Ecologists)
library(rethinking)
```


## Carp movement data

- 71 carp that approached a dam or lock on the Mississippi River
- `Pass` is `0` if the fish did not enter, `1` if it did
- Binomial distribution / Bernoulli trials

What is the probability of a carp entering the dam or lock?

```{r}
#| echo: true
#| output-location: slide
Carp <- carppassage |> 
  filter(Sound == 0) |> 
  mutate(Date = mdy(Date)) |> 
  arrange(Date) |> 
  select(Pass, FishID, Date)

Carp
```


## Carp movement data

```{r}
#| echo: true

Carp |> 
  group_by(Pass) |> 
  count()
```

- 9 of 71 carp passed
- P[Pass] = 9/71 = `r 9/71`
- Could approximate a confidence interval for the proportion (probability)


## Visualizing binomial probabilities

```{r}
#| echo: true
#| output-location: slide

ggplot() +
  geom_bar(data = tibble(Pass = 0:25,
                         Density = dbinom(Pass, 71, prob = 9/71)),
           aes(x = Pass, y = Density),
           stat = "identity") +
  geom_bar(data = tibble(Pass = 9,
                         Density = dbinom(Pass, 71, prob = 9/71)),
           aes(x = Pass, y = Density),
           stat = "identity",
           fill = "red") +
  labs(title = "0 to 25 successes in 71 trials for P = 9/71")
```


## Logistic regression via maximum likelihood

- `~ 1` tells `glm()` to fit only an intercept
- Specify `"binomial"` response

```{r}
#| echo: true
#| output-location: slide

fm <- glm(Pass ~ 1, data = Carp,
          family = "binomial")
summary(fm)
```


## Compare to raw proportion

- Convert logit `(Intercept)` to probability 
- Also using `rethinking::logistic()`

```{r}
#| echo: true
1/(1 + exp(-coef(fm)))
logistic(coef(fm))
9/71
```


## What have we learned so far?

- Maximum likelihood estimate of the mean of Bernoulli trials is the proportion of successes.
  - Note: no additional predictors; "mean" only
- Can approximate a confidence interval by one of ~5 methods
- We can do all this without Bayes or sampling

<br />

<center>
*So why Bayesian inference?*
</center>

